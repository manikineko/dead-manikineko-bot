import { ApplicationCommandType, CommandInteraction, InteractionType } from "discord.js";
import { client } from "robo.js";
const CHAR_LIMIT = 2000;
export function chunkMessage(message) {
    const chunks = [];
    let tempStr = '';
    // Split the message into paragraphs
    const paragraphs = message.split('\n\n');
    for(let i = 0; i < paragraphs.length; i++){
        const paragraph = paragraphs[i];
        const words = paragraph.split(' ');
        for (const word of words){
            // If adding the next word exceeds the limit, push the tempStr to chunks
            if ((tempStr + word).length + 1 > CHAR_LIMIT) {
                chunks.push(tempStr.trim());
                tempStr = '';
            }
            tempStr += word + ' ';
        }
        // Check if adding the next paragraph (including '\n\n') exceeds the limit, if so, push the current tempStr to chunks
        if (i < paragraphs.length - 1 && (tempStr + '\n\n' + paragraphs[i + 1]).length > CHAR_LIMIT) {
            chunks.push(tempStr.trim());
            tempStr = '';
        } else if (i < paragraphs.length - 1) {
            tempStr += '\n\n';
        }
    }
    // Push any remaining string to chunks
    if (tempStr.trim().length > 0) {
        chunks.push(tempStr.trim());
    }
    return chunks.filter(Boolean);
}
export function mockInteraction(channel, member, args) {
    // Create a mock CommandInteraction to pass to the function handler
    let interationMemberData = undefined;
    if (member) {
        interationMemberData = {
            user: {
                id: member.user.id,
                username: member.user.username,
                discriminator: member.user.discriminator,
                avatar: member.user.avatar
            },
            flags: member?.flags ?? 0,
            roles: member?.roles?.cache?.map((role)=>role.id) ?? [],
            premium_since: member?.premiumSince?.toISOString() ?? null,
            permissions: member?.permissions?.bitfield?.toString() ?? '',
            pending: member?.pending ?? false,
            nick: member?.nickname,
            mute: false,
            joined_at: member?.joinedAt?.toISOString() ?? '',
            deaf: false
        };
    }
    const interactionData = {
        id: Date.now().toString(),
        application_id: client.user?.id ?? 'mock',
        type: InteractionType.ApplicationCommand,
        app_permissions: member?.permissions?.bitfield?.toString() ?? '',
        channel: {
            id: channel?.id ?? '',
            type: channel?.type ?? 0
        },
        data: {
            type: ApplicationCommandType.ChatInput,
            name: 'mock',
            id: 'mock'
        },
        guild_id: member?.guild?.id,
        channel_id: channel?.id ?? '',
        locale: 'en-US',
        member: interationMemberData,
        token: 'mock',
        version: 1
    };
    // @ts-expect-error - Mock
    const interaction = new CommandInteraction(client, interactionData);
    interaction.options = {
        // @ts-expect-error - Mock
        get (key) {
            const val = args[key];
            return {
                get channel () {
                    const result = member?.guild?.channels?.cache?.find((channel)=>{
                        return channel.name === val;
                    });
                    // logger.debug(`Got channel for "${key}" value "${val}"`, result)
                    return result;
                },
                get member () {
                    const result = member?.guild?.members?.cache?.find((member)=>{
                        return member.user.username === val;
                    });
                    // logger.debug(`Got member for "${key}" value "${val}"`, result)
                    return result;
                },
                get role () {
                    const cleanValue = val.replace('@', '');
                    const result = member?.guild?.roles?.cache?.find((role)=>{
                        return role.name === cleanValue;
                    });
                    // logger.debug(`Got role for "${key}" value "${cleanValue}"`, result)
                    return result;
                },
                get user () {
                    const result = member?.guild?.members?.cache?.find((member)=>{
                        return member.user.username === val;
                    })?.user;
                    // logger.debug(`Got user for "${key}" value "${val}"`, result)
                    return result;
                },
                value: val
            };
        },
        getMember: (key)=>{
            const userId = args[key].trim().replace(/\D/g, '');
            return member?.guild?.members?.cache?.get(userId) ?? null;
        },
        getUser: (key)=>{
            const userId = args[key].trim().replace(/\D/g, '');
            return member?.guild?.members?.cache?.get(userId)?.user;
        }
    };
    let replyResolve;
    const replyPromise = new Promise((resolve)=>{
        replyResolve = resolve;
    });
    // @ts-expect-error - Mock
    interaction.deferReply = async ()=>{
        return mockMessage('', channel);
    };
    // @ts-expect-error - Mock
    interaction.reply = async (content)=>{
        replyResolve(content);
        return mockMessage(content, channel);
    };
    interaction.editReply = async (content)=>{
        replyResolve(content);
        return mockMessage(content, channel);
    };
    return {
        interaction,
        replyPromise
    };
}
export function mockMessage(content, channel) {
    const messageData = {
        id: Date.now().toString(),
        type: 0,
        channel_id: channel?.id ?? '',
        content: typeof content === 'string' ? content : content.content ?? '',
        timestamp: new Date().toISOString(),
        edited_timestamp: null,
        tts: false,
        mention_everyone: false,
        mention_roles: [],
        mentions: [],
        pinned: false,
        attachments: [],
        embeds: [],
        author: {
            id: client.user?.id ?? 'mock',
            username: client.user?.username ?? 'mock',
            discriminator: client.user?.discriminator ?? '0',
            avatar: client.user?.avatar ?? 'mock'
        }
    };
    // @ts-expect-error - Private constructor
    return new Message(client, messageData);
}
export function replaceUsernamesWithIds(text, map) {
    let result = '';
    let buffer = '';
    for(let i = 0; i < text.length; ++i){
        if (text[i] === '@') {
            if (buffer in map) {
                result += `<@${map[buffer]}>`;
            } else {
                result += buffer;
            }
            buffer = '';
        } else if (text[i].match(/\b/)) {
            buffer += text[i];
        } else {
            if (buffer in map) {
                result += `<@${map[buffer]}>`;
            } else {
                result += buffer;
            }
            buffer = text[i];
        }
    }
    if (buffer in map) {
        result += `<@${map[buffer]}>`;
    } else {
        result += buffer;
    }
    return result;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL3J1bm5lci93b3JrL3JvYm8uanMvcm9iby5qcy9wYWNrYWdlcy9wbHVnaW4tYWkvc3JjL3V0aWxzL2Rpc2NvcmQtdXRpbHMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwbGljYXRpb25Db21tYW5kVHlwZSwgQ29tbWFuZEludGVyYWN0aW9uLCBJbnRlcmFjdGlvblR5cGUgfSBmcm9tICdkaXNjb3JkLmpzJ1xuaW1wb3J0IHsgY2xpZW50IH0gZnJvbSAncm9iby5qcydcbmltcG9ydCB0eXBlIHtcblx0QVBJSW50ZXJhY3Rpb24sXG5cdEFQSU1lc3NhZ2UsXG5cdEd1aWxkTWVtYmVyLFxuXHRHdWlsZE1lbWJlckZsYWdzLFxuXHRJbnRlcmFjdGlvblJlcGx5T3B0aW9ucyxcblx0TWVzc2FnZSxcblx0VGV4dEJhc2VkQ2hhbm5lbCxcblx0VXNlclxufSBmcm9tICdkaXNjb3JkLmpzJ1xuXG5jb25zdCBDSEFSX0xJTUlUID0gMjAwMFxuXG5leHBvcnQgZnVuY3Rpb24gY2h1bmtNZXNzYWdlKG1lc3NhZ2U6IHN0cmluZyk6IHN0cmluZ1tdIHtcblx0Y29uc3QgY2h1bmtzOiBzdHJpbmdbXSA9IFtdXG5cdGxldCB0ZW1wU3RyID0gJydcblxuXHQvLyBTcGxpdCB0aGUgbWVzc2FnZSBpbnRvIHBhcmFncmFwaHNcblx0Y29uc3QgcGFyYWdyYXBocyA9IG1lc3NhZ2Uuc3BsaXQoJ1xcblxcbicpXG5cblx0Zm9yIChsZXQgaSA9IDA7IGkgPCBwYXJhZ3JhcGhzLmxlbmd0aDsgaSsrKSB7XG5cdFx0Y29uc3QgcGFyYWdyYXBoID0gcGFyYWdyYXBoc1tpXVxuXHRcdGNvbnN0IHdvcmRzID0gcGFyYWdyYXBoLnNwbGl0KCcgJylcblxuXHRcdGZvciAoY29uc3Qgd29yZCBvZiB3b3Jkcykge1xuXHRcdFx0Ly8gSWYgYWRkaW5nIHRoZSBuZXh0IHdvcmQgZXhjZWVkcyB0aGUgbGltaXQsIHB1c2ggdGhlIHRlbXBTdHIgdG8gY2h1bmtzXG5cdFx0XHRpZiAoKHRlbXBTdHIgKyB3b3JkKS5sZW5ndGggKyAxID4gQ0hBUl9MSU1JVCkge1xuXHRcdFx0XHRjaHVua3MucHVzaCh0ZW1wU3RyLnRyaW0oKSlcblx0XHRcdFx0dGVtcFN0ciA9ICcnXG5cdFx0XHR9XG5cdFx0XHR0ZW1wU3RyICs9IHdvcmQgKyAnICdcblx0XHR9XG5cblx0XHQvLyBDaGVjayBpZiBhZGRpbmcgdGhlIG5leHQgcGFyYWdyYXBoIChpbmNsdWRpbmcgJ1xcblxcbicpIGV4Y2VlZHMgdGhlIGxpbWl0LCBpZiBzbywgcHVzaCB0aGUgY3VycmVudCB0ZW1wU3RyIHRvIGNodW5rc1xuXHRcdGlmIChpIDwgcGFyYWdyYXBocy5sZW5ndGggLSAxICYmICh0ZW1wU3RyICsgJ1xcblxcbicgKyBwYXJhZ3JhcGhzW2kgKyAxXSkubGVuZ3RoID4gQ0hBUl9MSU1JVCkge1xuXHRcdFx0Y2h1bmtzLnB1c2godGVtcFN0ci50cmltKCkpXG5cdFx0XHR0ZW1wU3RyID0gJydcblx0XHR9IGVsc2UgaWYgKGkgPCBwYXJhZ3JhcGhzLmxlbmd0aCAtIDEpIHtcblx0XHRcdHRlbXBTdHIgKz0gJ1xcblxcbidcblx0XHR9XG5cdH1cblxuXHQvLyBQdXNoIGFueSByZW1haW5pbmcgc3RyaW5nIHRvIGNodW5rc1xuXHRpZiAodGVtcFN0ci50cmltKCkubGVuZ3RoID4gMCkge1xuXHRcdGNodW5rcy5wdXNoKHRlbXBTdHIudHJpbSgpKVxuXHR9XG5cblx0cmV0dXJuIGNodW5rcy5maWx0ZXIoQm9vbGVhbilcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG1vY2tJbnRlcmFjdGlvbihcblx0Y2hhbm5lbDogVGV4dEJhc2VkQ2hhbm5lbCB8IG51bGwgfCB1bmRlZmluZWQsXG5cdG1lbWJlcjogR3VpbGRNZW1iZXIgfCBudWxsIHwgdW5kZWZpbmVkLFxuXHRhcmdzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+XG4pIHtcblx0Ly8gQ3JlYXRlIGEgbW9jayBDb21tYW5kSW50ZXJhY3Rpb24gdG8gcGFzcyB0byB0aGUgZnVuY3Rpb24gaGFuZGxlclxuXHRsZXQgaW50ZXJhdGlvbk1lbWJlckRhdGEgPSB1bmRlZmluZWRcblx0aWYgKG1lbWJlcikge1xuXHRcdGludGVyYXRpb25NZW1iZXJEYXRhID0ge1xuXHRcdFx0dXNlcjoge1xuXHRcdFx0XHRpZDogbWVtYmVyLnVzZXIuaWQsXG5cdFx0XHRcdHVzZXJuYW1lOiBtZW1iZXIudXNlci51c2VybmFtZSxcblx0XHRcdFx0ZGlzY3JpbWluYXRvcjogbWVtYmVyLnVzZXIuZGlzY3JpbWluYXRvcixcblx0XHRcdFx0YXZhdGFyOiBtZW1iZXIudXNlci5hdmF0YXJcblx0XHRcdH0sXG5cdFx0XHRmbGFnczogKG1lbWJlcj8uZmxhZ3MgPz8gMCkgYXMgdW5rbm93biBhcyBHdWlsZE1lbWJlckZsYWdzLFxuXHRcdFx0cm9sZXM6IG1lbWJlcj8ucm9sZXM/LmNhY2hlPy5tYXAoKHJvbGUpID0+IHJvbGUuaWQpID8/IFtdLFxuXHRcdFx0cHJlbWl1bV9zaW5jZTogbWVtYmVyPy5wcmVtaXVtU2luY2U/LnRvSVNPU3RyaW5nKCkgPz8gbnVsbCxcblx0XHRcdHBlcm1pc3Npb25zOiBtZW1iZXI/LnBlcm1pc3Npb25zPy5iaXRmaWVsZD8udG9TdHJpbmcoKSA/PyAnJyxcblx0XHRcdHBlbmRpbmc6IG1lbWJlcj8ucGVuZGluZyA/PyBmYWxzZSxcblx0XHRcdG5pY2s6IG1lbWJlcj8ubmlja25hbWUsXG5cdFx0XHRtdXRlOiBmYWxzZSxcblx0XHRcdGpvaW5lZF9hdDogbWVtYmVyPy5qb2luZWRBdD8udG9JU09TdHJpbmcoKSA/PyAnJyxcblx0XHRcdGRlYWY6IGZhbHNlXG5cdFx0fVxuXHR9XG5cdGNvbnN0IGludGVyYWN0aW9uRGF0YTogQVBJSW50ZXJhY3Rpb24gPSB7XG5cdFx0aWQ6IERhdGUubm93KCkudG9TdHJpbmcoKSxcblx0XHRhcHBsaWNhdGlvbl9pZDogY2xpZW50LnVzZXI/LmlkID8/ICdtb2NrJyxcblx0XHR0eXBlOiBJbnRlcmFjdGlvblR5cGUuQXBwbGljYXRpb25Db21tYW5kLFxuXHRcdGFwcF9wZXJtaXNzaW9uczogbWVtYmVyPy5wZXJtaXNzaW9ucz8uYml0ZmllbGQ/LnRvU3RyaW5nKCkgPz8gJycsXG5cdFx0Y2hhbm5lbDoge1xuXHRcdFx0aWQ6IGNoYW5uZWw/LmlkID8/ICcnLFxuXHRcdFx0dHlwZTogY2hhbm5lbD8udHlwZSA/PyAwXG5cdFx0fSxcblx0XHRkYXRhOiB7XG5cdFx0XHR0eXBlOiBBcHBsaWNhdGlvbkNvbW1hbmRUeXBlLkNoYXRJbnB1dCxcblx0XHRcdG5hbWU6ICdtb2NrJyxcblx0XHRcdGlkOiAnbW9jaydcblx0XHR9LFxuXHRcdGd1aWxkX2lkOiBtZW1iZXI/Lmd1aWxkPy5pZCxcblx0XHRjaGFubmVsX2lkOiBjaGFubmVsPy5pZCA/PyAnJyxcblx0XHRsb2NhbGU6ICdlbi1VUycsXG5cdFx0bWVtYmVyOiBpbnRlcmF0aW9uTWVtYmVyRGF0YSxcblx0XHR0b2tlbjogJ21vY2snLCAvLyBUaGlzIHNob3VsZCBiZSBhIHZhbGlkIGludGVyYWN0aW9uIHRva2VuLCBidXQgdGhlcmUncyBubyB3YXkgdG8gbW9jayB0aGlzXG5cdFx0dmVyc2lvbjogMVxuXHR9XG5cblx0Ly8gQHRzLWV4cGVjdC1lcnJvciAtIE1vY2tcblx0Y29uc3QgaW50ZXJhY3Rpb246IENvbW1hbmRJbnRlcmFjdGlvbiA9IG5ldyBDb21tYW5kSW50ZXJhY3Rpb24oY2xpZW50LCBpbnRlcmFjdGlvbkRhdGEpXG5cdGludGVyYWN0aW9uLm9wdGlvbnMgPSB7XG5cdFx0Ly8gQHRzLWV4cGVjdC1lcnJvciAtIE1vY2tcblx0XHRnZXQoa2V5OiBzdHJpbmcpIHtcblx0XHRcdGNvbnN0IHZhbCA9IGFyZ3Nba2V5XVxuXG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRnZXQgY2hhbm5lbCgpIHtcblx0XHRcdFx0XHRjb25zdCByZXN1bHQgPSBtZW1iZXI/Lmd1aWxkPy5jaGFubmVscz8uY2FjaGU/LmZpbmQoKGNoYW5uZWwpID0+IHtcblx0XHRcdFx0XHRcdHJldHVybiBjaGFubmVsLm5hbWUgPT09IHZhbFxuXHRcdFx0XHRcdH0pXG5cblx0XHRcdFx0XHQvLyBsb2dnZXIuZGVidWcoYEdvdCBjaGFubmVsIGZvciBcIiR7a2V5fVwiIHZhbHVlIFwiJHt2YWx9XCJgLCByZXN1bHQpXG5cdFx0XHRcdFx0cmV0dXJuIHJlc3VsdFxuXHRcdFx0XHR9LFxuXG5cdFx0XHRcdGdldCBtZW1iZXIoKSB7XG5cdFx0XHRcdFx0Y29uc3QgcmVzdWx0ID0gbWVtYmVyPy5ndWlsZD8ubWVtYmVycz8uY2FjaGU/LmZpbmQoKG1lbWJlcikgPT4ge1xuXHRcdFx0XHRcdFx0cmV0dXJuIG1lbWJlci51c2VyLnVzZXJuYW1lID09PSB2YWxcblx0XHRcdFx0XHR9KVxuXG5cdFx0XHRcdFx0Ly8gbG9nZ2VyLmRlYnVnKGBHb3QgbWVtYmVyIGZvciBcIiR7a2V5fVwiIHZhbHVlIFwiJHt2YWx9XCJgLCByZXN1bHQpXG5cdFx0XHRcdFx0cmV0dXJuIHJlc3VsdFxuXHRcdFx0XHR9LFxuXG5cdFx0XHRcdGdldCByb2xlKCkge1xuXHRcdFx0XHRcdGNvbnN0IGNsZWFuVmFsdWUgPSB2YWwucmVwbGFjZSgnQCcsICcnKVxuXHRcdFx0XHRcdGNvbnN0IHJlc3VsdCA9IG1lbWJlcj8uZ3VpbGQ/LnJvbGVzPy5jYWNoZT8uZmluZCgocm9sZSkgPT4ge1xuXHRcdFx0XHRcdFx0cmV0dXJuIHJvbGUubmFtZSA9PT0gY2xlYW5WYWx1ZVxuXHRcdFx0XHRcdH0pXG5cblx0XHRcdFx0XHQvLyBsb2dnZXIuZGVidWcoYEdvdCByb2xlIGZvciBcIiR7a2V5fVwiIHZhbHVlIFwiJHtjbGVhblZhbHVlfVwiYCwgcmVzdWx0KVxuXHRcdFx0XHRcdHJldHVybiByZXN1bHRcblx0XHRcdFx0fSxcblxuXHRcdFx0XHRnZXQgdXNlcigpIHtcblx0XHRcdFx0XHRjb25zdCByZXN1bHQgPSBtZW1iZXI/Lmd1aWxkPy5tZW1iZXJzPy5jYWNoZT8uZmluZCgobWVtYmVyKSA9PiB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gbWVtYmVyLnVzZXIudXNlcm5hbWUgPT09IHZhbFxuXHRcdFx0XHRcdH0pPy51c2VyXG5cblx0XHRcdFx0XHQvLyBsb2dnZXIuZGVidWcoYEdvdCB1c2VyIGZvciBcIiR7a2V5fVwiIHZhbHVlIFwiJHt2YWx9XCJgLCByZXN1bHQpXG5cdFx0XHRcdFx0cmV0dXJuIHJlc3VsdFxuXHRcdFx0XHR9LFxuXG5cdFx0XHRcdHZhbHVlOiB2YWxcblx0XHRcdH1cblx0XHR9LFxuXG5cdFx0Z2V0TWVtYmVyOiAoa2V5OiBzdHJpbmcpID0+IHtcblx0XHRcdGNvbnN0IHVzZXJJZCA9IGFyZ3Nba2V5XS50cmltKCkucmVwbGFjZSgvXFxEL2csICcnKVxuXHRcdFx0cmV0dXJuIG1lbWJlcj8uZ3VpbGQ/Lm1lbWJlcnM/LmNhY2hlPy5nZXQodXNlcklkKSA/PyBudWxsXG5cdFx0fSxcblxuXHRcdGdldFVzZXI6IChrZXk6IHN0cmluZykgPT4ge1xuXHRcdFx0Y29uc3QgdXNlcklkID0gYXJnc1trZXldLnRyaW0oKS5yZXBsYWNlKC9cXEQvZywgJycpXG5cdFx0XHRyZXR1cm4gbWVtYmVyPy5ndWlsZD8ubWVtYmVycz8uY2FjaGU/LmdldCh1c2VySWQpPy51c2VyIGFzIFVzZXJcblx0XHR9XG5cdH1cblxuXHRsZXQgcmVwbHlSZXNvbHZlOiAoY29udGVudDogc3RyaW5nIHwgSW50ZXJhY3Rpb25SZXBseU9wdGlvbnMpID0+IHZvaWRcblx0Y29uc3QgcmVwbHlQcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcblx0XHRyZXBseVJlc29sdmUgPSByZXNvbHZlXG5cdH0pXG5cdC8vIEB0cy1leHBlY3QtZXJyb3IgLSBNb2NrXG5cdGludGVyYWN0aW9uLmRlZmVyUmVwbHkgPSBhc3luYyAoKSA9PiB7XG5cdFx0cmV0dXJuIG1vY2tNZXNzYWdlKCcnLCBjaGFubmVsKVxuXHR9XG5cdC8vIEB0cy1leHBlY3QtZXJyb3IgLSBNb2NrXG5cdGludGVyYWN0aW9uLnJlcGx5ID0gYXN5bmMgKGNvbnRlbnQ6IHN0cmluZyB8IEludGVyYWN0aW9uUmVwbHlPcHRpb25zKSA9PiB7XG5cdFx0cmVwbHlSZXNvbHZlKGNvbnRlbnQpXG5cdFx0cmV0dXJuIG1vY2tNZXNzYWdlKGNvbnRlbnQsIGNoYW5uZWwpXG5cdH1cblx0aW50ZXJhY3Rpb24uZWRpdFJlcGx5ID0gYXN5bmMgKGNvbnRlbnQ6IHN0cmluZyB8IEludGVyYWN0aW9uUmVwbHlPcHRpb25zKSA9PiB7XG5cdFx0cmVwbHlSZXNvbHZlKGNvbnRlbnQpXG5cdFx0cmV0dXJuIG1vY2tNZXNzYWdlKGNvbnRlbnQsIGNoYW5uZWwpXG5cdH1cblxuXHRyZXR1cm4geyBpbnRlcmFjdGlvbiwgcmVwbHlQcm9taXNlIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG1vY2tNZXNzYWdlKFxuXHRjb250ZW50OiBzdHJpbmcgfCBJbnRlcmFjdGlvblJlcGx5T3B0aW9ucyxcblx0Y2hhbm5lbDogVGV4dEJhc2VkQ2hhbm5lbCB8IG51bGwgfCB1bmRlZmluZWRcbik6IE1lc3NhZ2Uge1xuXHRjb25zdCBtZXNzYWdlRGF0YTogQVBJTWVzc2FnZSA9IHtcblx0XHRpZDogRGF0ZS5ub3coKS50b1N0cmluZygpLFxuXHRcdHR5cGU6IDAsXG5cdFx0Y2hhbm5lbF9pZDogY2hhbm5lbD8uaWQgPz8gJycsXG5cdFx0Y29udGVudDogdHlwZW9mIGNvbnRlbnQgPT09ICdzdHJpbmcnID8gY29udGVudCA6IGNvbnRlbnQuY29udGVudCA/PyAnJyxcblx0XHR0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcblx0XHRlZGl0ZWRfdGltZXN0YW1wOiBudWxsLFxuXHRcdHR0czogZmFsc2UsXG5cdFx0bWVudGlvbl9ldmVyeW9uZTogZmFsc2UsXG5cdFx0bWVudGlvbl9yb2xlczogW10sXG5cdFx0bWVudGlvbnM6IFtdLFxuXHRcdHBpbm5lZDogZmFsc2UsXG5cdFx0YXR0YWNobWVudHM6IFtdLFxuXHRcdGVtYmVkczogW10sXG5cdFx0YXV0aG9yOiB7XG5cdFx0XHRpZDogY2xpZW50LnVzZXI/LmlkID8/ICdtb2NrJyxcblx0XHRcdHVzZXJuYW1lOiBjbGllbnQudXNlcj8udXNlcm5hbWUgPz8gJ21vY2snLFxuXHRcdFx0ZGlzY3JpbWluYXRvcjogY2xpZW50LnVzZXI/LmRpc2NyaW1pbmF0b3IgPz8gJzAnLFxuXHRcdFx0YXZhdGFyOiBjbGllbnQudXNlcj8uYXZhdGFyID8/ICdtb2NrJ1xuXHRcdH1cblx0fVxuXG5cdC8vIEB0cy1leHBlY3QtZXJyb3IgLSBQcml2YXRlIGNvbnN0cnVjdG9yXG5cdHJldHVybiBuZXcgTWVzc2FnZShjbGllbnQsIG1lc3NhZ2VEYXRhKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVwbGFjZVVzZXJuYW1lc1dpdGhJZHModGV4dDogc3RyaW5nLCBtYXA6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4pOiBzdHJpbmcge1xuXHRsZXQgcmVzdWx0ID0gJydcblx0bGV0IGJ1ZmZlciA9ICcnXG5cblx0Zm9yIChsZXQgaSA9IDA7IGkgPCB0ZXh0Lmxlbmd0aDsgKytpKSB7XG5cdFx0aWYgKHRleHRbaV0gPT09ICdAJykge1xuXHRcdFx0aWYgKGJ1ZmZlciBpbiBtYXApIHtcblx0XHRcdFx0cmVzdWx0ICs9IGA8QCR7bWFwW2J1ZmZlcl19PmBcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHJlc3VsdCArPSBidWZmZXJcblx0XHRcdH1cblx0XHRcdGJ1ZmZlciA9ICcnXG5cdFx0fSBlbHNlIGlmICh0ZXh0W2ldLm1hdGNoKC9cXGIvKSkge1xuXHRcdFx0YnVmZmVyICs9IHRleHRbaV1cblx0XHR9IGVsc2Uge1xuXHRcdFx0aWYgKGJ1ZmZlciBpbiBtYXApIHtcblx0XHRcdFx0cmVzdWx0ICs9IGA8QCR7bWFwW2J1ZmZlcl19PmBcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHJlc3VsdCArPSBidWZmZXJcblx0XHRcdH1cblx0XHRcdGJ1ZmZlciA9IHRleHRbaV1cblx0XHR9XG5cdH1cblxuXHRpZiAoYnVmZmVyIGluIG1hcCkge1xuXHRcdHJlc3VsdCArPSBgPEAke21hcFtidWZmZXJdfT5gXG5cdH0gZWxzZSB7XG5cdFx0cmVzdWx0ICs9IGJ1ZmZlclxuXHR9XG5cblx0cmV0dXJuIHJlc3VsdFxufVxuIl0sIm5hbWVzIjpbIkFwcGxpY2F0aW9uQ29tbWFuZFR5cGUiLCJDb21tYW5kSW50ZXJhY3Rpb24iLCJJbnRlcmFjdGlvblR5cGUiLCJjbGllbnQiLCJDSEFSX0xJTUlUIiwiY2h1bmtNZXNzYWdlIiwibWVzc2FnZSIsImNodW5rcyIsInRlbXBTdHIiLCJwYXJhZ3JhcGhzIiwic3BsaXQiLCJpIiwibGVuZ3RoIiwicGFyYWdyYXBoIiwid29yZHMiLCJ3b3JkIiwicHVzaCIsInRyaW0iLCJmaWx0ZXIiLCJCb29sZWFuIiwibW9ja0ludGVyYWN0aW9uIiwiY2hhbm5lbCIsIm1lbWJlciIsImFyZ3MiLCJpbnRlcmF0aW9uTWVtYmVyRGF0YSIsInVuZGVmaW5lZCIsInVzZXIiLCJpZCIsInVzZXJuYW1lIiwiZGlzY3JpbWluYXRvciIsImF2YXRhciIsImZsYWdzIiwicm9sZXMiLCJjYWNoZSIsIm1hcCIsInJvbGUiLCJwcmVtaXVtX3NpbmNlIiwicHJlbWl1bVNpbmNlIiwidG9JU09TdHJpbmciLCJwZXJtaXNzaW9ucyIsImJpdGZpZWxkIiwidG9TdHJpbmciLCJwZW5kaW5nIiwibmljayIsIm5pY2tuYW1lIiwibXV0ZSIsImpvaW5lZF9hdCIsImpvaW5lZEF0IiwiZGVhZiIsImludGVyYWN0aW9uRGF0YSIsIkRhdGUiLCJub3ciLCJhcHBsaWNhdGlvbl9pZCIsInR5cGUiLCJBcHBsaWNhdGlvbkNvbW1hbmQiLCJhcHBfcGVybWlzc2lvbnMiLCJkYXRhIiwiQ2hhdElucHV0IiwibmFtZSIsImd1aWxkX2lkIiwiZ3VpbGQiLCJjaGFubmVsX2lkIiwibG9jYWxlIiwidG9rZW4iLCJ2ZXJzaW9uIiwiaW50ZXJhY3Rpb24iLCJvcHRpb25zIiwiZ2V0Iiwia2V5IiwidmFsIiwicmVzdWx0IiwiY2hhbm5lbHMiLCJmaW5kIiwibWVtYmVycyIsImNsZWFuVmFsdWUiLCJyZXBsYWNlIiwidmFsdWUiLCJnZXRNZW1iZXIiLCJ1c2VySWQiLCJnZXRVc2VyIiwicmVwbHlSZXNvbHZlIiwicmVwbHlQcm9taXNlIiwiUHJvbWlzZSIsInJlc29sdmUiLCJkZWZlclJlcGx5IiwibW9ja01lc3NhZ2UiLCJyZXBseSIsImNvbnRlbnQiLCJlZGl0UmVwbHkiLCJtZXNzYWdlRGF0YSIsInRpbWVzdGFtcCIsImVkaXRlZF90aW1lc3RhbXAiLCJ0dHMiLCJtZW50aW9uX2V2ZXJ5b25lIiwibWVudGlvbl9yb2xlcyIsIm1lbnRpb25zIiwicGlubmVkIiwiYXR0YWNobWVudHMiLCJlbWJlZHMiLCJhdXRob3IiLCJNZXNzYWdlIiwicmVwbGFjZVVzZXJuYW1lc1dpdGhJZHMiLCJ0ZXh0IiwiYnVmZmVyIiwibWF0Y2giXSwibWFwcGluZ3MiOiJBQUFBLFNBQVNBLHNCQUFzQixFQUFFQyxrQkFBa0IsRUFBRUMsZUFBZSxRQUFRLGFBQVk7QUFDeEYsU0FBU0MsTUFBTSxRQUFRLFVBQVM7QUFZaEMsTUFBTUMsYUFBYTtBQUVuQixPQUFPLFNBQVNDLGFBQWFDLE9BQWUsRUFBWTtJQUN2RCxNQUFNQyxTQUFtQixFQUFFO0lBQzNCLElBQUlDLFVBQVU7SUFFZCxvQ0FBb0M7SUFDcEMsTUFBTUMsYUFBYUgsUUFBUUksS0FBSyxDQUFDO0lBRWpDLElBQUssSUFBSUMsSUFBSSxHQUFHQSxJQUFJRixXQUFXRyxNQUFNLEVBQUVELElBQUs7UUFDM0MsTUFBTUUsWUFBWUosVUFBVSxDQUFDRSxFQUFFO1FBQy9CLE1BQU1HLFFBQVFELFVBQVVILEtBQUssQ0FBQztRQUU5QixLQUFLLE1BQU1LLFFBQVFELE1BQU87WUFDekIsd0VBQXdFO1lBQ3hFLElBQUksQUFBQ04sQ0FBQUEsVUFBVU8sSUFBRyxFQUFHSCxNQUFNLEdBQUcsSUFBSVIsWUFBWTtnQkFDN0NHLE9BQU9TLElBQUksQ0FBQ1IsUUFBUVMsSUFBSTtnQkFDeEJULFVBQVU7WUFDWCxDQUFDO1lBQ0RBLFdBQVdPLE9BQU87UUFDbkI7UUFFQSxxSEFBcUg7UUFDckgsSUFBSUosSUFBSUYsV0FBV0cs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